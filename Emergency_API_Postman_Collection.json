{
  "info": {
    "_postman_id": "emergency-api-collection",
    "name": "Emergency API - Complete Collection",
    "description": "Complete API collection for Emergency Response System with Relawan Shift Management",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "https://sigap-api-5hk6r.ondigitalocean.app/api",
      "type": "string"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "panic_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "report_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üîê Authentication",
      "item": [
        {
          "name": "Register User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Test User\",\n    \"email\": \"testuser@example.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"no_telp\": \"081234567890\",\n    \"alamat\": \"Jl. Test No. 123\",\n    \"nik\": \"1234567890123456\",\n    \"tanggal_lahir\": \"1995-01-01\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/register",
              "host": ["{{base_url}}"],
              "path": ["register"]
            }
          }
        },
        {
          "name": "Register Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Admin User\",\n    \"email\": \"admin@example.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"no_telp\": \"081234567891\",\n    \"alamat\": \"Jl. Admin No. 123\",\n    \"nik\": \"1234567890123457\",\n    \"tanggal_lahir\": \"1990-01-01\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/register-admin",
              "host": ["{{base_url}}"],
              "path": ["admin", "register-admin"]
            }
          }
        },
        {
          "name": "Register Relawan",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Relawan User\",\n    \"email\": \"relawan@example.com\",\n    \"password\": \"password123\",\n    \"password_confirmation\": \"password123\",\n    \"no_telp\": \"081234567892\",\n    \"alamat\": \"Jl. Relawan No. 123\",\n    \"nik\": \"1234567890123458\",\n    \"tanggal_lahir\": \"1992-01-01\",\n    \"nim\": \"24060122130001\",\n    \"jurusan\": \"Teknik Informatika\",\n    \"angkatan\": \"2022\",\n    \"status_relawan\": \"active\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/register-relawan",
              "host": ["{{base_url}}"],
              "path": ["admin", "register-relawan"]
            }
          }
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('auth_token', response.token);",
                  "    pm.collectionVariables.set('user_id', response.user.id);",
                  "    console.log('Token saved:', response.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"tesdzikri@students.undip.ac.id\",\n    \"password\": \"password\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/login",
              "host": ["{{base_url}}"],
              "path": ["login"]
            }
          }
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/refresh",
              "host": ["{{base_url}}"],
              "path": ["refresh"]
            }
          }
        },
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/profile",
              "host": ["{{base_url}}"],
              "path": ["profile"]
            }
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            },
            "url": {
              "raw": "{{base_url}}/logout",
              "host": ["{{base_url}}"],
              "path": ["logout"]
            }
          }
        }
      ]
    },
    {
      "name": "üö® Emergency/Panic Reports",
      "item": [
        {
          "name": "Send Panic Alert",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": ["if (pm.response.code === 201) {", "    const response = pm.response.json();", "    pm.collectionVariables.set('panic_id', response.panic.id);", "    console.log('Panic ID saved:', response.panic.id);", "}"],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"latitude\": -7.2575,\n    \"longitude\": 112.7521,\n    \"location_description\": \"Dekat kampus UNDIP, area parkir timur\",\n    \"emergency_type\": \"medical\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/panic",
              "host": ["{{base_url}}"],
              "path": ["panic"]
            }
          }
        },
        {
          "name": "Get Today Panic Reports (User)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/panic-today",
              "host": ["{{base_url}}"],
              "path": ["panic-today"]
            }
          }
        },
        {
          "name": "Get Today Panic Reports (Relawan)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/panic/relawan-today",
              "host": ["{{base_url}}"],
              "path": ["panic", "relawan-today"]
            }
          }
        },
        {
          "name": "Get All Panic Reports (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/panic/admin",
              "host": ["{{base_url}}"],
              "path": ["panic", "admin"]
            }
          }
        },
        {
          "name": "Handle Panic Report",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"response_notes\": \"Tim medis sedang dalam perjalanan ke lokasi\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/panic/{{panic_id}}/handle",
              "host": ["{{base_url}}"],
              "path": ["panic", "{{panic_id}}", "handle"]
            }
          }
        },
        {
          "name": "Resolve Panic Report",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"resolution_notes\": \"Situasi darurat telah ditangani dengan baik. Korban sudah aman.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/panic/{{panic_id}}/resolve",
              "host": ["{{base_url}}"],
              "path": ["panic", "{{panic_id}}", "resolve"]
            }
          }
        }
      ]
    },
    {
      "name": "üë§ User Management",
      "item": [
        {
          "name": "Get All Users (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/users",
              "host": ["{{base_url}}"],
              "path": ["admin", "users"]
            }
          }
        },
        {
          "name": "Get All Relawan (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/relawan",
              "host": ["{{base_url}}"],
              "path": ["admin", "relawan"]
            }
          }
        },
        {
          "name": "Get User by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/users/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["users", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Name\",\n    \"no_telp\": \"081234567899\",\n    \"alamat\": \"Jl. Updated Address No. 456\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/users/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["users", "{{user_id}}"]
            }
          }
        },
        {
          "name": "Delete User (Admin)",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/users/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["admin", "users", "{{user_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "üïí Relawan Shift Management",
      "item": [
        {
          "name": "Get My Shifts (Relawan)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/relawan/shifts/me",
              "host": ["{{base_url}}"],
              "path": ["relawan", "shifts", "me"]
            }
          }
        },
        {
          "name": "Get All Shifts (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shifts",
              "host": ["{{base_url}}"],
              "path": ["admin", "shifts"]
            }
          }
        },
        {
          "name": "Get Week Shifts (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shifts/week?start_date=2025-06-01",
              "host": ["{{base_url}}"],
              "path": ["admin", "shifts", "week"],
              "query": [
                {
                  "key": "start_date",
                  "value": "2025-06-01"
                }
              ]
            }
          }
        },
        {
          "name": "Create Manual Shift",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"relawan_id\": 2,\n    \"shift_date\": \"2025-06-15\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/shifts",
              "host": ["{{base_url}}"],
              "path": ["admin", "shifts"]
            }
          }
        },
        {
          "name": "Auto Assign Shifts",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"start_date\": \"2025-06-01\",\n    \"end_date\": \"2025-06-07\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/shifts/auto-assign",
              "host": ["{{base_url}}"],
              "path": ["admin", "shifts", "auto-assign"]
            }
          }
        },
        {
          "name": "Delete Shifts by Date",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shifts/2025-06-15",
              "host": ["{{base_url}}"],
              "path": ["admin", "shifts", "2025-06-15"]
            }
          }
        },
        {
          "name": "Get Relawans for Shifts",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/relawans",
              "host": ["{{base_url}}"],
              "path": ["admin", "relawans"]
            }
          }
        }
      ]
    },
    {
      "name": "üìã Shift Patterns Management",
      "item": [
        {
          "name": "Get All Shift Patterns",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns"]
            }
          }
        },
        {
          "name": "Create Shift Pattern",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"relawan_id\": 2,\n    \"day_of_week\": 1,\n    \"is_active\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns"]
            }
          }
        },
        {
          "name": "Get Relawan Shift Patterns",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns/relawan?relawan_id=2",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns", "relawan"],
              "query": [
                {
                  "key": "relawan_id",
                  "value": "2"
                }
              ]
            }
          }
        },
        {
          "name": "Copy Shift Pattern from Another Relawan",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"from_relawan_id\": 2,\n    \"to_relawan_id\": 3\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns/copy",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns", "copy"]
            }
          }
        },
        {
          "name": "Generate Shifts from Patterns",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"start_date\": \"2025-06-01\",\n    \"end_date\": \"2025-06-30\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns/generate-shifts",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns", "generate-shifts"]
            }
          }
        },
        {
          "name": "Delete Shift Pattern by Day",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns/day/1?relawan_id=2",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns", "day", "1"],
              "query": [
                {
                  "key": "relawan_id",
                  "value": "2"
                }
              ]
            }
          }
        },
        {
          "name": "Delete Shift Pattern by ID",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/shift-patterns/1",
              "host": ["{{base_url}}"],
              "path": ["admin", "shift-patterns", "1"]
            }
          }
        }
      ]
    },
    {
      "name": "üìù Reports Management",
      "item": [
        {
          "name": "Get All Reports",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/reports",
              "host": ["{{base_url}}"],
              "path": ["reports"]
            }
          }
        },
        {
          "name": "Create Report",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": ["if (pm.response.code === 201) {", "    const response = pm.response.json();", "    pm.collectionVariables.set('report_id', response.report.id);", "    console.log('Report ID saved:', response.report.id);", "}"],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"problem_type\": \"infrastruktur\",\n    \"description\": \"Lampu jalan di depan kampus tidak menyala sudah 3 hari\",\n    \"location\": \"Jl. Prof. Soedarto, SH, Tembalang\",\n    \"latitude\": -7.2575,\n    \"longitude\": 112.7521,\n    \"urgency_level\": \"medium\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/reports",
              "host": ["{{base_url}}"],
              "path": ["reports"]
            }
          }
        },
        {
          "name": "Get Report by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/reports/{{report_id}}",
              "host": ["{{base_url}}"],
              "path": ["reports", "{{report_id}}"]
            }
          }
        },
        {
          "name": "Update Report",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"description\": \"Lampu jalan di depan kampus tidak menyala sudah 3 hari - UPDATE: Sudah dilaporkan ke PLN\",\n    \"urgency_level\": \"high\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/reports/{{report_id}}",
              "host": ["{{base_url}}"],
              "path": ["reports", "{{report_id}}"]
            }
          }
        },
        {
          "name": "Delete Report",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/reports/{{report_id}}",
              "host": ["{{base_url}}"],
              "path": ["reports", "{{report_id}}"]
            }
          }
        },
        {
          "name": "Get Problem Types",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/problem-types",
              "host": ["{{base_url}}"],
              "path": ["problem-types"]
            }
          }
        },
        {
          "name": "Upload Photo",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "photo",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/upload-photo",
              "host": ["{{base_url}}"],
              "path": ["upload-photo"]
            }
          }
        }
      ]
    },
    {
      "name": "üìä Dashboard & Admin",
      "item": [
        {
          "name": "Admin Dashboard",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/dashboard",
              "host": ["{{base_url}}"],
              "path": ["admin", "dashboard"]
            }
          }
        },
        {
          "name": "Relawan Dashboard",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/relawan/dashboard",
              "host": ["{{base_url}}"],
              "path": ["relawan", "dashboard"]
            }
          }
        },
        {
          "name": "Get All Users for Admin",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/all-users",
              "host": ["{{base_url}}"],
              "path": ["admin", "all-users"]
            }
          }
        }
      ]
    }
  ]
}
